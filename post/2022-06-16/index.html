<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=generator content="Hugo 0.100.2"><title>2022년 6월 15일 &#183; KYUBUEM's Devlog 2022</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css><!--[if lte IE 8]><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css><!--<![endif]--><!--[if lte IE 8]><link rel=stylesheet href=https://kyubuem.github.io/css/side-menu-old-ie.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://kyubuem.github.io/css/side-menu.css><!--<![endif]--><link rel=stylesheet href=https://kyubuem.github.io/css/blackburn.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel=stylesheet type=text/css><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><link rel="shortcut icon" href=https://kyubuem.github.io/img/favicon.ico type=image/x-icon></head><body><div id=layout><a href=#menu id=menuLink class=menu-link><span></span></a><div id=menu><a class="pure-menu-heading brand" href=https://kyubuem.github.io/>KYUBUEM</a><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=https://kyubuem.github.io/><i class='fa fa-home fa-fw'></i>Home</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://kyubuem.github.io/post/><i class='fa fa-list fa-fw'></i>Post</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://kyubuem.github.io/about/><i class='fa fa-user fa-fw'></i>About</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://kyubuem.github.io/categories/devstory/><i class='fa fa-book fa-fw'></i>DevStory</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://kyubuem.github.io/tags/><i class='fa fa-tags fa-fw'></i>Tags</a></li></ul></div><div class="pure-menu social"><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=https://linkedin.com/in/kyubuem-lim-5741039b rel=me target=_blank><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://github.com/kyubuem rel=me target=_blank><i class="fab fa-github-square fa-fw"></i>GitHub</a></li></ul></div><div><div class=small-print><small>&copy; 2022. All rights reserved.</small></div><div class=small-print><small>Built with&nbsp;<a href=https://gohugo.io/ target=_blank>Hugo</a></small>
<small>Theme&nbsp;<a href=https://github.com/yoshiharuyamashita/blackburn target=_blank>Blackburn</a></small></div></div></div><div id=main><div class=header><h1>2022년 6월 15일</h1><h2></h2></div><div class=content><div class=post-meta><div><i class="fa fa-calendar fa-fw"></i>
<time>15 Jun 2022</time></div><div><i class="fa fa-tags fa-fw"></i>
<a class=post-taxonomy-tag href=https://kyubuem.github.io/tags/nginx>Nginx</a>&nbsp;/
<a class=post-taxonomy-tag href=https://kyubuem.github.io/tags/digest>Digest</a></div></div><h3 id=nginx>Nginx</h3><p>ReactJS 로 데모 준비를 진행하던 도중에 CORS 에러가 발생하였다. 장비의 웹서버인 Nginx에서는 CORS에 대한 response header를 제공해주지 않아서 Origin에 대한 allow 정책이 맞지 않아서 API 호출시 에러가 발생하는 이슈이다. 개발서버에서 장비로 API 호출시 Origin URL과 장비의 URL이 맞지 않아서 CORS 설정을 해줘야 하는 상황이다.</p><p>Nginx의 설정에서 간단하게 cors 설정을 해줄수 있었다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ cd /etc/nginx/nginx.cfg
</span></span><span style=display:flex><span>location / <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  add_header <span style=color:#e6db74>&#39;Access-Control-Allow-Origin&#39;</span> <span style=color:#e6db74>&#39;*&#39;</span> always;
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>always를 설정해주지 않았을 경우 장비의 인증절차에서 Access-Control-Allow-Origin을 제공하지 않아서 cors 에러가 발생하였다. always를 통해서 항상 리턴하도록 설정하였다.
이게 맞는 설정방법은 아닐것이다. 테스트를 하기 위함이여서 임시방편이겠지만 우선 동작테스트를 해야만 했다. 기능 구현이 완료 되고 장비의 웹서버에 연동한다면 cors 설정을 좀더 세부적으로 고민해야 할 것 같다.</p><h3 id=digest-와-axios>Digest 와 axios</h3><p>ReactJS를 통해서 장비의 api에 접근하려면 digest 인증 절차를 거쳐야 한다. cli를 구현해서 테스트 하였을 때는 digest인증이 정상적으로 되었기 때문에 node기반 패키지에서도 문제없이 될 것이라고 생각했다. axios-digest 패키지를 설치해서 테스트 해보니 내부 에러 발생하여 더이상의 테스트가 불가능 하였다. 401 에러 리턴후 정상적으로 response 헤더를 파싱해야 하는데 파싱에러가 발생하는 것이었다. www-authenticate 파싱과 authenticate 헤더를 생성하는 알고리즘을 직접 구현해보는게 좋을 것 같다.</p><p><img src=https://kyubuem.github.io/img/HTTP_Digest_Example.png alt="Digest 인증 절차"></p><h4><i class="fas fa-share-alt" aria-hidden=true></i>&nbsp;Share!</h4><ul class=share-buttons><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fkyubuem.github.io%2fpost%2f2022-06-16%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook" aria-hidden=true></i><span class=sr-only>Share on Facebook</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fkyubuem.github.io%2fpost%2f2022-06-16%2f" target=_blank title=Tweet><i class="fab fa-twitter" aria-hidden=true></i><span class=sr-only>Tweet</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://plus.google.com/share?url=https%3a%2f%2fkyubuem.github.io%2fpost%2f2022-06-16%2f" target=_blank title="Share on Google+"><i class="fab fa-google-plus" aria-hidden=true></i><span class=sr-only>Share on Google+</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fkyubuem.github.io%2fpost%2f2022-06-16%2f" target=_blank title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden=true></i><span class=sr-only>Post to Tumblr</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fkyubuem.github.io%2fpost%2f2022-06-16%2f" target=_blank title="Pin it"><i class="fab fa-pinterest-p" aria-hidden=true></i><span class=sr-only>Pin it</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fkyubuem.github.io%2fpost%2f2022-06-16%2f" target=_blank title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden=true></i><span class=sr-only>Submit to Reddit</span></a></li></ul><style>ul.share-buttons{list-style:none;padding:0}ul.share-buttons li{display:inline}ul.share-buttons .sr-only{position:absolute;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}</style><div class="prev-next-post pure-g"><div class=pure-u-1-24 style=text-align:left></div><div class=pure-u-10-24></div><div class=pure-u-2-24>&nbsp;</div><div class=pure-u-10-24></div><div class=pure-u-1-24 style=text-align:right></div></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement('script');e.type='text/javascript',e.async=!0,t='kyubuemlim',e.src='//'+t+'.disqus.com/embed.js',(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><script src=https://kyubuem.github.io/js/ui.js></script>
<script src=https://kyubuem.github.io/js/menus.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ET60TQLKNR"></script>
<script>if(window.location.hostname!="localhost"){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-ET60TQLKNR')}</script><script src=https://kyubuem.github.io/js/math-code.js></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>